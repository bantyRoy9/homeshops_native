import { createSlice, PayloadAction } from "@reduxjs/toolkit";
import buildEPCExtraReducers from "./Store.Builders";
import { IProduct, TProducts } from "./type";
export type initialStateTy = {
  products: TProducts,
  addtocard: any,
  product:any
}

export const initialState: initialStateTy = {
  products: [],
  addtocard: {},
  product:{"rating":0,"brands_data":{"deeplink":{"url":"grofers://collection-products?collection_filters=[{\"brand_id\":[1744]}]&collection_name=Amul"},"name":"Amul","title":"View all products by Amul"},"video_url":null,"attribute_collection":[{"description":null,"title":"Highlights","show_group":true,"attributes":[{"title":"Full Cream Milk","url":null,"detail":null,"value":"Type","help_text":null,"type":"shown_to_customer"}],"type":"PDP","name":"Highlights"},{"attributes":[{"title":"Description","url":null,"detail":null,"value":"Amul Gold Full Cream Milk (Polypack) Milk is homogenized toned pasteurized milk. Rich and creamy, this milk is an excellent source of vitamin A and vitamin D that enhances growth and development of the body tissues and the brain.","help_text":null,"type":"shown_to_customer"},{"title":"Key Features","url":null,"detail":null,"value":"Wholesome and healthy\nPasteurised milk\nRich in calcium","help_text":null,"type":"shown_to_customer"},{"title":"Unit","url":null,"detail":null,"value":"500 ml","help_text":null,"type":"shown_to_customer"},{"title":"FSSAI License","url":null,"detail":null,"value":"10018021003047","help_text":null,"type":"shown_to_customer"}],"title":"Highlights","type":"attribute","description":null,"name":"Highlights - Milk"},{"attributes":[{"title":"Shelf Life","url":null,"detail":null,"value":"2 days","help_text":null,"type":"shown_to_customer"},{"title":"Return Policy","url":null,"detail":null,"value":"The product is non-returnable. For a damaged, defective, expired or incorrect item, you can request a replacement within 24 hours of delivery. \n In case of an incorrect item, you may raise a replacement or return request only if the item is sealed/ unopened/ unused and in original condition.","help_text":null,"type":"shown_to_customer"},{"title":"Packaging Type","url":null,"detail":null,"value":"Pack","help_text":null,"type":"shown_to_customer"},{"title":"Country of Origin","url":null,"detail":null,"value":"India","help_text":null,"type":"shown_to_customer"},{"title":"Customer Care Details","url":null,"detail":null,"value":"Email: info@blinkit.com","help_text":null,"type":"shown_to_customer"},{"title":"Disclaimer","url":null,"detail":null,"value":"Every effort is made to maintain the accuracy of all information. However, actual product packaging and materials may contain more and/or different information. It is recommended not to solely rely on the information presented.","help_text":null,"type":"shown_to_customer"},{"value":"Bigway Marketing Private Limited","title":"Seller"},{"value":"13323999000312","title":"Seller FSSAI"}],"title":"Info","type":"attribute","description":null,"name":"Info"}],"mrp":34,"priority_image_url":"https://cdn.grofers.com/app/assets/products/large_images/jpeg/4198835a-3d44-4eef-a456-e794211d2e67.jpg?ts=1706182142","product_meta":null,"has_details":null,"group_name":"","mapping_id":102831838,"brand_id":1744,"offer":"","sbc_price":null,"b2b_inventory":null,"has_inventory":true,"attributes":{"food_type":"veg","product_tag":""},"badges":[],"unit_type":null,"options":null,"pid_mapping":{},"derived_attributes":null,"pricing_comment":null,"level1_category":[{"parent_id":0,"id":922,"name":"Milk"}],"unit_price":null,"name":"Amul Gold Full Cream Fresh Milk","priority":"","rating_count":null,"unit":"500 ml","line_1":null,"line_2":null,"type":"Fresh Milk","brand":"Amul","inventory":12,"recommended_purchase_quantity":null,"product_badges":[{"text":"earliest","label":"eta","bg_color":"#F5F5F5","image_url":"http://cdn.grofers.com/assets/eta-icons/15-mins.png","text_color":"#263238","type":"ETA"}],"tags":null,"title":null,"price":34,"incentives":null,"user_message_limit":null,"level0_category":[{"parent_id":0,"id":14,"name":"Dairy & Breakfast"}],"rating_star_color":"#D23333","type_id":623,"is_selected":false,"merchant_id":31372,"pl_flag":null,"eta_product_badge":{"text":"earliest","label":"eta","bg_color":"#F5F5F5","image_url":"http://cdn.grofers.com/assets/eta-icons/15-mins.png","text_color":"#263238","type":"ETA"},"eta_tag":{"background_color":"#FFF6C2","text":"earliest delivery","text_color":"#000000","icon_image_uri":"http://cdn.grofers.com/assets/eta-icons/15-mins.png","background_color_v2":"#F7F7F7","background_opacity":1,"icon":"FLASH_ENABLED"},"product_id":12872,"image_overlay_tags":null,"sbc_enabled":null,"assets":[{"video_info":null,"sort_order":-1,"image_url":"https://cdn.grofers.com/app/assets/products/large_images/jpeg/4198835a-3d44-4eef-a456-e794211d2e67.jpg?ts=1706182142","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":1,"image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1c0db977-31ab-4d8e-abf3-d42e4a4b4632.jpg?ts=1706182142","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":2,"image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1f30c58c-9655-48a6-ae89-bbec2a39e869.jpg","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":3,"image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/d718c88e-52bd-4be1-a6b6-260d8608ffe9.jpg","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":4,"image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/937d1ef4-618c-4a7a-867c-b96f3ea6ed13.jpg","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":5,"image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1f92cadb-2e7e-4ed7-8d43-c357c6538813.jpg","asset_type":"image","video_auto_play":null},{"video_info":null,"sort_order":6,"image_url":"https://cdn.grofers.com/app/images/products/common/customer_care.jpg","asset_type":"image","video_auto_play":null}],"variant_attribute_name":null,"variant_meta":null,"rating_count_text":null,"rating_flag":false,"sbc_offer":"","merchant_type":"Express","leaf_category":{"parent_id":0,"id":1185,"name":"Fresh Milk"},"received_at_ts":null,"reviews":{"reviews_list":[],"show_new_badge":true,"title":"Customer Reviews"},"highlight_images":null,"rating_text_color":"#D23333","image_url":"https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1c0db977-31ab-4d8e-abf3-d42e4a4b4632.jpg?ts=1706182142","cta":null,"sbc_unit_price":null,"availability_status":"","group_id":1287277,"combo_flag":null,"sliding_images":["https://cdn.grofers.com/app/assets/products/large_images/jpeg/4198835a-3d44-4eef-a456-e794211d2e67.jpg?ts=1706182142","https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1c0db977-31ab-4d8e-abf3-d42e4a4b4632.jpg?ts=1706182142","https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1f30c58c-9655-48a6-ae89-bbec2a39e869.jpg","https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/d718c88e-52bd-4be1-a6b6-260d8608ffe9.jpg","https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/937d1ef4-618c-4a7a-867c-b96f3ea6ed13.jpg","https://cdn.grofers.com/app/assets/products/sliding_images/jpeg/1f92cadb-2e7e-4ed7-8d43-c357c6538813.jpg","https://cdn.grofers.com/app/images/products/common/customer_care.jpg"]}
}
const storeDetailSlice = createSlice({
  name: 'storeDetails',
  initialState,
  reducers: {
    addItem: ({ addtocard }, { payload: { product, type } }: PayloadAction<{ product: IProduct; type?: -1 | 1 }>) => {
      const product_id = product.id;
      if (type === -1 && product_id) {
        addtocard[product_id].splice(0, 1);
        if (!addtocard[product_id].length) delete addtocard[product_id]
      } else {
        if(!addtocard){
          addtocard = {}
        }
        addtocard[product_id] = [...(addtocard[product_id] || []), product]
      }
    },
    clearCart: (state) => {
      state.addtocard.items = [];
      state.addtocard.total = 0;
    },
  },
  extraReducers: buildEPCExtraReducers
});
export const { addItem } = storeDetailSlice.actions;
export default storeDetailSlice.reducer;